

```python
%run NeuralNetwork_MNIST.ipynb
```


```python
import warnings
import skopt
from skopt import gp_minimize, forest_minimize
from skopt.space import Real, Categorical, Integer
from skopt.plots import plot_convergence
from skopt.plots import plot_objective, plot_evaluations
from skopt.utils import use_named_args
from tensorflow.keras.models import load_model
warnings.filterwarnings(action='ignore')
```

I will check hyperparameters combinations from following hyperparameters list.
            
- learning rate: 10^-4 ~ 10^-1
- number of layers: 2 ~ 10
- number of nodes: 10 ~ 300
- hidden activation function: sigmoid, tanh, relu

To use scikit optimize, we have to make dimension of hyperparameters .


```python
dim_learning_rate = Real(low = 1e-4, high = 1e-1, prior = 'log-uniform', name = 'learning_rate')

dim_num_layers = Integer(low = 3, high = 10, name = 'num_layers')


dim_num_nodes = Integer(low = 10, high = 300, name = 'num_nodes')


dim_hidden_activation = Categorical(categories = ['sigmoid','tanh','relu'], name = 'hidden_activation')

dimensions = [dim_learning_rate,
              dim_num_layers,
              dim_num_nodes,
              dim_hidden_activation]
```

And, let's set best model name: 'best_model.keras' and default best accuracy: 0. During tuning, best combination model will be saved as 'best_model.keras' and best accuracy will be updated. 


```python
path_best_model = 'best_model.keras'

best_accuracy = 0.0
```

log_dir_name function will be used when we save tensorboard of model of each hypermarameter combinations. And let's denote test set as validation_data.


```python
def log_dir_name(learning_rate, num_layers, num_nodes, hidden_activation):
    log_dir_temp = "tf_logs/Hypertuning/lr_{}_layers_{}_nodes_{}_activation_{}"
    log_dir = log_dir_temp.format(learning_rate,
                                  num_layers,
                                  num_nodes,
                                  hidden_activation)
    return log_dir
```


```python
validation_data = (test_images.T, test_labels.T)
```

fitness function will caculate accuracy of model of each hyperparameters combinations. Since gp_minimize, which I will use for hyperparameter tuning, is minimization function, the fitness function return -accuracy.


```python
@use_named_args(dimensions = dimensions)
def fitness(learning_rate, num_layers, num_nodes, hidden_activation):
    print('learning_rate : {}'.format(learning_rate))
    print('num_layers : {}'.format(num_layers))
    print('num_nodes : {}'.format(num_nodes))
    print('hidden_activation : {}'.format(hidden_activation))
    print('--------------------------------------------------------------')
    
    model = create_model(learning_rate = learning_rate, num_layers = num_layers, num_nodes = num_nodes, hidden_activation = hidden_activation)
    
    log_dir = log_dir_name(learning_rate, num_layers, num_nodes, hidden_activation)
    
    callback_log = TensorBoard(
        log_dir = log_dir,
        histogram_freq = 0,
        batch_size = 32,
        write_graph = True,
        write_grads = False,
        write_images = False)
    
    history = model.fit(x = train_images.T,
                        y = train_labels.T,
                        epochs = 5,
                        batch_size = 64,
                        validation_data = validation_data,
                        callbacks = [callback_log])
    
    accuracy = history.history['val_accuracy'][-1]
    
    print('Accuracy: {}'.format(accuracy))
    print('===============================================================')
    
    global best_accuracy
    
    if accuracy > best_accuracy:
        model.save(path_best_model)
        best_accuracy = accuracy
        
    del model
    K.clear_session()
    
    return -accuracy
```

Let's test fitness function with default_parameters.


```python
default_parameters = [0.01, 3, 16, 'relu']

fitness(x = default_parameters)
```

    learning_rate : 0.01
    num_layers : 3
    num_nodes : 16
    hidden_activation : relu
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 2s 34us/sample - loss: 0.6026 - accuracy: 0.7893 - val_loss: 0.4848 - val_accuracy: 0.8273
    Epoch 2/5
    60000/60000 [==============================] - 2s 28us/sample - loss: 0.4684 - accuracy: 0.8353 - val_loss: 0.5019 - val_accuracy: 0.8281
    Epoch 3/5
    60000/60000 [==============================] - 1s 25us/sample - loss: 0.4513 - accuracy: 0.8416 - val_loss: 0.4834 - val_accuracy: 0.8336
    Epoch 4/5
    60000/60000 [==============================] - 1s 24us/sample - loss: 0.4391 - accuracy: 0.8452 - val_loss: 0.5206 - val_accuracy: 0.8229
    Epoch 5/5
    60000/60000 [==============================] - 2s 26us/sample - loss: 0.4317 - accuracy: 0.8466 - val_loss: 0.4922 - val_accuracy: 0.8278
    Accuracy: 0.8277999758720398
    ===============================================================





    -0.8278



Now, let's find best hyperparameters combinations with gp_minimize.

gp_minimize : Bayesian optimization using Gaussian Processes.

If every function evaluation is expensive, for instance when the parameters are the hyperparameters of a neural network and the function evaluation is the mean cross-validation score across ten folds, optimizing the hyperparameters by standard optimization routines would take for ever!

The idea is to approximate the function using a Gaussian process. In other words the function values are assumed to follow a multivariate gaussian. The covariance of the function values are given by a GP kernel between the parameters. Then a smart choice to choose the next parameter to evaluate can be made by the acquisition function over the Gaussian prior which is much quicker to evaluate.

(https://scikit-optimize.github.io/#skopt.gp_minimize)


```python
search_result_gp = gp_minimize(func = fitness,
                               dimensions = dimensions,
                               acq_func = 'EI',
                               n_calls = 50,
                               x0 = default_parameters)
```

    learning_rate : 0.01
    num_layers : 3
    num_nodes : 16
    hidden_activation : relu
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 2s 34us/sample - loss: 0.5351 - accuracy: 0.8112 - val_loss: 0.4627 - val_accuracy: 0.8365
    Epoch 2/5
    60000/60000 [==============================] - 2s 28us/sample - loss: 0.4352 - accuracy: 0.8452 - val_loss: 0.4499 - val_accuracy: 0.8396
    Epoch 3/5
    60000/60000 [==============================] - 2s 27us/sample - loss: 0.4177 - accuracy: 0.8512 - val_loss: 0.4732 - val_accuracy: 0.8314
    Epoch 4/5
    60000/60000 [==============================] - 2s 33us/sample - loss: 0.4047 - accuracy: 0.8550 - val_loss: 0.4712 - val_accuracy: 0.8340
    Epoch 5/5
    60000/60000 [==============================] - 2s 31us/sample - loss: 0.3981 - accuracy: 0.8570 - val_loss: 0.4623 - val_accuracy: 0.8422
    Accuracy: 0.842199981212616
    ===============================================================
    learning_rate : 0.006895924135039323
    num_layers : 3
    num_nodes : 104
    hidden_activation : tanh
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 3s 56us/sample - loss: 0.5269 - accuracy: 0.8069 - val_loss: 0.5656 - val_accuracy: 0.7908
    Epoch 2/5
    60000/60000 [==============================] - 3s 45us/sample - loss: 0.4634 - accuracy: 0.8348 - val_loss: 0.4991 - val_accuracy: 0.8223
    Epoch 3/5
    60000/60000 [==============================] - 2s 39us/sample - loss: 0.4388 - accuracy: 0.8436 - val_loss: 0.4509 - val_accuracy: 0.8418
    Epoch 4/5
    60000/60000 [==============================] - 2s 34us/sample - loss: 0.4208 - accuracy: 0.8492 - val_loss: 0.4708 - val_accuracy: 0.8344
    Epoch 5/5
    60000/60000 [==============================] - 2s 35us/sample - loss: 0.4321 - accuracy: 0.8449 - val_loss: 0.4702 - val_accuracy: 0.8379
    Accuracy: 0.8378999829292297
    ===============================================================
    learning_rate : 0.022647322808239126
    num_layers : 7
    num_nodes : 33
    hidden_activation : tanh
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 4s 69us/sample - loss: 0.9937 - accuracy: 0.6296 - val_loss: 0.9507 - val_accuracy: 0.6456
    Epoch 2/5
    60000/60000 [==============================] - 2s 39us/sample - loss: 1.0856 - accuracy: 0.5759 - val_loss: 1.0253 - val_accuracy: 0.6296
    Epoch 3/5
    60000/60000 [==============================] - 2s 35us/sample - loss: 1.1860 - accuracy: 0.5194 - val_loss: 1.2889 - val_accuracy: 0.5038
    Epoch 4/5
    60000/60000 [==============================] - 2s 34us/sample - loss: 1.2865 - accuracy: 0.4646 - val_loss: 1.6906 - val_accuracy: 0.2602
    Epoch 5/5
    60000/60000 [==============================] - 2s 38us/sample - loss: 1.6366 - accuracy: 0.3007 - val_loss: 1.9635 - val_accuracy: 0.1981
    Accuracy: 0.1981000006198883
    ===============================================================
    learning_rate : 0.0035170843253272
    num_layers : 8
    num_nodes : 165
    hidden_activation : sigmoid
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 6s 98us/sample - loss: 1.1980 - accuracy: 0.4763 - val_loss: 0.7439 - val_accuracy: 0.7130
    Epoch 2/5
    60000/60000 [==============================] - 5s 86us/sample - loss: 0.6765 - accuracy: 0.7285 - val_loss: 0.6700 - val_accuracy: 0.7258
    Epoch 3/5
    60000/60000 [==============================] - 5s 84us/sample - loss: 0.5564 - accuracy: 0.8014 - val_loss: 0.5229 - val_accuracy: 0.8255
    Epoch 4/5
    60000/60000 [==============================] - 5s 83us/sample - loss: 0.4579 - accuracy: 0.8440 - val_loss: 0.4549 - val_accuracy: 0.8445
    Epoch 5/5
    60000/60000 [==============================] - 4s 74us/sample - loss: 0.4054 - accuracy: 0.8579 - val_loss: 0.4567 - val_accuracy: 0.8350
    Accuracy: 0.8349999785423279
    ===============================================================
    learning_rate : 0.0007907043448046097
    num_layers : 4
    num_nodes : 166
    hidden_activation : relu
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 3s 56us/sample - loss: 0.5063 - accuracy: 0.8189 - val_loss: 0.4170 - val_accuracy: 0.8506
    Epoch 2/5
    60000/60000 [==============================] - 3s 48us/sample - loss: 0.3678 - accuracy: 0.8655 - val_loss: 0.4005 - val_accuracy: 0.8562
    Epoch 3/5
    60000/60000 [==============================] - 3s 44us/sample - loss: 0.3280 - accuracy: 0.8791 - val_loss: 0.3613 - val_accuracy: 0.8702
    Epoch 4/5
    60000/60000 [==============================] - 3s 44us/sample - loss: 0.3011 - accuracy: 0.8880 - val_loss: 0.3392 - val_accuracy: 0.8781
    Epoch 5/5
    60000/60000 [==============================] - 2s 41us/sample - loss: 0.2815 - accuracy: 0.8959 - val_loss: 0.3509 - val_accuracy: 0.8694
    Accuracy: 0.8694000244140625
    ===============================================================
    learning_rate : 0.02789772608931511
    num_layers : 5
    num_nodes : 68
    hidden_activation : relu
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 3s 46us/sample - loss: 0.6818 - accuracy: 0.7583 - val_loss: 0.5589 - val_accuracy: 0.8077
    Epoch 2/5
    60000/60000 [==============================] - 2s 36us/sample - loss: 0.5448 - accuracy: 0.8128 - val_loss: 0.6093 - val_accuracy: 0.8077
    Epoch 3/5
    60000/60000 [==============================] - 2s 33us/sample - loss: 0.5386 - accuracy: 0.8199 - val_loss: 0.5341 - val_accuracy: 0.8268
    Epoch 4/5
    60000/60000 [==============================] - 2s 32us/sample - loss: 0.5720 - accuracy: 0.8113 - val_loss: 0.6252 - val_accuracy: 0.7923
    Epoch 5/5
    60000/60000 [==============================] - 2s 33us/sample - loss: 0.5778 - accuracy: 0.8088 - val_loss: 0.5685 - val_accuracy: 0.8165
    Accuracy: 0.8165000081062317
    ===============================================================
    learning_rate : 0.01797254097359066
    num_layers : 8
    num_nodes : 296
    hidden_activation : tanh
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 7s 113us/sample - loss: 2.6560 - accuracy: 0.1014 - val_loss: 2.8107 - val_accuracy: 0.1000
    Epoch 2/5
    60000/60000 [==============================] - 6s 100us/sample - loss: 2.5989 - accuracy: 0.1014 - val_loss: 2.4675 - val_accuracy: 0.1000
    Epoch 3/5
    60000/60000 [==============================] - 6s 100us/sample - loss: 2.6049 - accuracy: 0.0997 - val_loss: 2.6739 - val_accuracy: 0.1000
    Epoch 4/5
    60000/60000 [==============================] - 6s 97us/sample - loss: 2.5866 - accuracy: 0.1013 - val_loss: 2.6692 - val_accuracy: 0.1000
    Epoch 5/5
    60000/60000 [==============================] - 6s 93us/sample - loss: 2.6132 - accuracy: 0.0989 - val_loss: 2.5704 - val_accuracy: 0.1000
    Accuracy: 0.10000000149011612
    ===============================================================
    learning_rate : 0.08170670734796551
    num_layers : 3
    num_nodes : 296
    hidden_activation : tanh
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 3s 51us/sample - loss: 2.3228 - accuracy: 0.5571 - val_loss: 2.2860 - val_accuracy: 0.6158
    Epoch 2/5
    60000/60000 [==============================] - 3s 50us/sample - loss: 2.4697 - accuracy: 0.5799 - val_loss: 4.1705 - val_accuracy: 0.5223
    Epoch 3/5
    60000/60000 [==============================] - 3s 48us/sample - loss: 2.2414 - accuracy: 0.6033 - val_loss: 3.5668 - val_accuracy: 0.5171
    Epoch 4/5
    60000/60000 [==============================] - 3s 51us/sample - loss: 2.3234 - accuracy: 0.6205 - val_loss: 1.8816 - val_accuracy: 0.5976
    Epoch 5/5
    60000/60000 [==============================] - 3s 54us/sample - loss: 2.4010 - accuracy: 0.6094 - val_loss: 2.6066 - val_accuracy: 0.5979
    Accuracy: 0.5978999733924866
    ===============================================================
    learning_rate : 0.051740515195965626
    num_layers : 8
    num_nodes : 111
    hidden_activation : relu
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 5s 80us/sample - loss: 1.5400 - accuracy: 0.4800 - val_loss: 1.2425 - val_accuracy: 0.5051
    Epoch 2/5
    60000/60000 [==============================] - 4s 60us/sample - loss: 1.2236 - accuracy: 0.5117 - val_loss: 1.3125 - val_accuracy: 0.4589
    Epoch 3/5
    60000/60000 [==============================] - 3s 52us/sample - loss: 1.8686 - accuracy: 0.3104 - val_loss: 2.3146 - val_accuracy: 0.1000
    Epoch 4/5
    60000/60000 [==============================] - 3s 49us/sample - loss: 2.3106 - accuracy: 0.0991 - val_loss: 2.3082 - val_accuracy: 0.1000
    Epoch 5/5
    60000/60000 [==============================] - 3s 46us/sample - loss: 2.3088 - accuracy: 0.1005 - val_loss: 2.3072 - val_accuracy: 0.1000
    Accuracy: 0.10000000149011612
    ===============================================================
    learning_rate : 0.001789500674579953
    num_layers : 4
    num_nodes : 215
    hidden_activation : tanh
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 3s 57us/sample - loss: 0.4759 - accuracy: 0.8270 - val_loss: 0.4324 - val_accuracy: 0.8388
    Epoch 2/5
    60000/60000 [==============================] - 3s 49us/sample - loss: 0.3636 - accuracy: 0.8651 - val_loss: 0.3905 - val_accuracy: 0.8601
    Epoch 3/5
    60000/60000 [==============================] - 3s 48us/sample - loss: 0.3349 - accuracy: 0.8763 - val_loss: 0.3503 - val_accuracy: 0.8707
    Epoch 4/5
    60000/60000 [==============================] - 3s 48us/sample - loss: 0.3125 - accuracy: 0.8841 - val_loss: 0.3526 - val_accuracy: 0.8730
    Epoch 5/5
    60000/60000 [==============================] - 3s 49us/sample - loss: 0.3052 - accuracy: 0.8867 - val_loss: 0.3925 - val_accuracy: 0.8615
    Accuracy: 0.8615000247955322
    ===============================================================
    learning_rate : 0.012473355169066539
    num_layers : 8
    num_nodes : 245
    hidden_activation : relu
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 7s 111us/sample - loss: 0.7664 - accuracy: 0.7317 - val_loss: 0.7302 - val_accuracy: 0.7612
    Epoch 2/5
    60000/60000 [==============================] - 5s 91us/sample - loss: 0.6224 - accuracy: 0.7881 - val_loss: 0.6061 - val_accuracy: 0.7956
    Epoch 3/5
    60000/60000 [==============================] - 6s 96us/sample - loss: 0.5251 - accuracy: 0.8198 - val_loss: 0.5452 - val_accuracy: 0.8169
    Epoch 4/5
    60000/60000 [==============================] - 6s 93us/sample - loss: 0.5508 - accuracy: 0.8146 - val_loss: 0.5815 - val_accuracy: 0.7977
    Epoch 5/5
    60000/60000 [==============================] - 5s 90us/sample - loss: 0.5446 - accuracy: 0.8115 - val_loss: 0.5923 - val_accuracy: 0.8008
    Accuracy: 0.8008000254631042
    ===============================================================
    learning_rate : 0.007479620379616349
    num_layers : 6
    num_nodes : 161
    hidden_activation : relu
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 4s 72us/sample - loss: 0.5713 - accuracy: 0.7914 - val_loss: 0.4741 - val_accuracy: 0.8314
    Epoch 2/5
    60000/60000 [==============================] - 3s 57us/sample - loss: 0.4354 - accuracy: 0.8436 - val_loss: 0.4808 - val_accuracy: 0.8251
    Epoch 3/5
    60000/60000 [==============================] - 4s 59us/sample - loss: 0.4134 - accuracy: 0.8536 - val_loss: 0.4628 - val_accuracy: 0.8390
    Epoch 4/5
    60000/60000 [==============================] - 3s 58us/sample - loss: 0.3960 - accuracy: 0.8591 - val_loss: 0.4585 - val_accuracy: 0.8403
    Epoch 5/5
    60000/60000 [==============================] - 3s 57us/sample - loss: 0.3944 - accuracy: 0.8599 - val_loss: 0.4508 - val_accuracy: 0.8433
    Accuracy: 0.8432999849319458
    ===============================================================
    learning_rate : 0.002172644306702648
    num_layers : 3
    num_nodes : 11
    hidden_activation : relu
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 2s 39us/sample - loss: 0.6611 - accuracy: 0.7682 - val_loss: 0.5096 - val_accuracy: 0.8206
    Epoch 2/5
    60000/60000 [==============================] - 2s 30us/sample - loss: 0.4568 - accuracy: 0.8409 - val_loss: 0.4680 - val_accuracy: 0.8366
    Epoch 3/5
    60000/60000 [==============================] - 2s 28us/sample - loss: 0.4331 - accuracy: 0.8488 - val_loss: 0.4540 - val_accuracy: 0.8400
    Epoch 4/5
    60000/60000 [==============================] - 2s 28us/sample - loss: 0.4143 - accuracy: 0.8541 - val_loss: 0.4523 - val_accuracy: 0.8438
    Epoch 5/5
    60000/60000 [==============================] - 2s 29us/sample - loss: 0.4058 - accuracy: 0.8567 - val_loss: 0.4483 - val_accuracy: 0.8432
    Accuracy: 0.8432000279426575
    ===============================================================
    learning_rate : 0.0006150890428392201
    num_layers : 3
    num_nodes : 80
    hidden_activation : tanh
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 3s 44us/sample - loss: 0.5463 - accuracy: 0.8127 - val_loss: 0.4697 - val_accuracy: 0.8288
    Epoch 2/5
    60000/60000 [==============================] - 2s 34us/sample - loss: 0.3976 - accuracy: 0.8577 - val_loss: 0.4153 - val_accuracy: 0.8494
    Epoch 3/5
    60000/60000 [==============================] - 2s 32us/sample - loss: 0.3627 - accuracy: 0.8701 - val_loss: 0.4007 - val_accuracy: 0.8596
    Epoch 4/5
    60000/60000 [==============================] - 2s 31us/sample - loss: 0.3420 - accuracy: 0.8778 - val_loss: 0.3853 - val_accuracy: 0.8627ccura
    Epoch 5/5
    60000/60000 [==============================] - 2s 30us/sample - loss: 0.3235 - accuracy: 0.8832 - val_loss: 0.3922 - val_accuracy: 0.8576
    Accuracy: 0.8575999736785889
    ===============================================================
    learning_rate : 0.0005418621776650285
    num_layers : 7
    num_nodes : 300
    hidden_activation : relu
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 6s 101us/sample - loss: 0.5003 - accuracy: 0.8199 - val_loss: 0.4244 - val_accuracy: 0.8541
    Epoch 2/5
    60000/60000 [==============================] - 5s 87us/sample - loss: 0.3636 - accuracy: 0.8683 - val_loss: 0.3919 - val_accuracy: 0.8553
    Epoch 3/5
    60000/60000 [==============================] - 6s 94us/sample - loss: 0.3297 - accuracy: 0.8780 - val_loss: 0.3987 - val_accuracy: 0.8594
    Epoch 4/5
    60000/60000 [==============================] - 5s 83us/sample - loss: 0.3036 - accuracy: 0.8867 - val_loss: 0.3613 - val_accuracy: 0.8679
    Epoch 5/5
    60000/60000 [==============================] - 5s 89us/sample - loss: 0.2828 - accuracy: 0.8935 - val_loss: 0.3631 - val_accuracy: 0.8628
    Accuracy: 0.8628000020980835
    ===============================================================
    learning_rate : 0.09115775385862808
    num_layers : 5
    num_nodes : 260
    hidden_activation : relu
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 4s 75us/sample - loss: 6.4358 - accuracy: 0.1002 - val_loss: 2.3125 - val_accuracy: 0.1002
    Epoch 2/5
    60000/60000 [==============================] - 4s 61us/sample - loss: 2.3099 - accuracy: 0.1011 - val_loss: 2.3104 - val_accuracy: 0.1002
    Epoch 3/5
    60000/60000 [==============================] - 3s 57us/sample - loss: 2.3102 - accuracy: 0.0993 - val_loss: 2.3067 - val_accuracy: 0.1002
    Epoch 4/5
    60000/60000 [==============================] - 4s 61us/sample - loss: 2.3106 - accuracy: 0.1006 - val_loss: 2.3064 - val_accuracy: 0.1002
    Epoch 5/5
    60000/60000 [==============================] - 4s 63us/sample - loss: 2.3103 - accuracy: 0.1021 - val_loss: 2.3170 - val_accuracy: 0.1002
    Accuracy: 0.10019999742507935
    ===============================================================
    learning_rate : 0.004035190927131013
    num_layers : 3
    num_nodes : 116
    hidden_activation : tanh
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 3s 47us/sample - loss: 0.4829 - accuracy: 0.8245 - val_loss: 0.4455 - val_accuracy: 0.8434
    Epoch 2/5
    60000/60000 [==============================] - 3s 45us/sample - loss: 0.4011 - accuracy: 0.8553 - val_loss: 0.4320 - val_accuracy: 0.8435
    Epoch 3/5
    60000/60000 [==============================] - 2s 41us/sample - loss: 0.3784 - accuracy: 0.8643 - val_loss: 0.4337 - val_accuracy: 0.8472
    Epoch 4/5
    60000/60000 [==============================] - 2s 36us/sample - loss: 0.3718 - accuracy: 0.8663 - val_loss: 0.4149 - val_accuracy: 0.8528
    Epoch 5/5
    60000/60000 [==============================] - 2s 38us/sample - loss: 0.3545 - accuracy: 0.8707 - val_loss: 0.4230 - val_accuracy: 0.8528
    Accuracy: 0.8528000116348267
    ===============================================================
    learning_rate : 0.0001001632284064687
    num_layers : 10
    num_nodes : 45
    hidden_activation : tanh
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 3s 53us/sample - loss: 0.8878 - accuracy: 0.7276 - val_loss: 0.5841 - val_accuracy: 0.8021
    Epoch 2/5
    60000/60000 [==============================] - 2s 35us/sample - loss: 0.5012 - accuracy: 0.8277 - val_loss: 0.4982 - val_accuracy: 0.8231
    Epoch 3/5
    60000/60000 [==============================] - 2s 38us/sample - loss: 0.4411 - accuracy: 0.8456 - val_loss: 0.4630 - val_accuracy: 0.8355
    Epoch 4/5
    60000/60000 [==============================] - 2s 35us/sample - loss: 0.4105 - accuracy: 0.8539 - val_loss: 0.4477 - val_accuracy: 0.8402
    Epoch 5/5
    60000/60000 [==============================] - 2s 37us/sample - loss: 0.3890 - accuracy: 0.8619 - val_loss: 0.4303 - val_accuracy: 0.8451
    Accuracy: 0.8450999855995178
    ===============================================================
    learning_rate : 0.0001
    num_layers : 4
    num_nodes : 137
    hidden_activation : sigmoid
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 3s 46us/sample - loss: 1.5262 - accuracy: 0.5887 - val_loss: 0.9865 - val_accuracy: 0.6922
    Epoch 2/5
    60000/60000 [==============================] - 2s 41us/sample - loss: 0.8027 - accuracy: 0.7431 - val_loss: 0.7050 - val_accuracy: 0.7604
    Epoch 3/5
    60000/60000 [==============================] - 2s 36us/sample - loss: 0.6237 - accuracy: 0.7899 - val_loss: 0.5932 - val_accuracy: 0.7927
    Epoch 4/5
    60000/60000 [==============================] - 2s 38us/sample - loss: 0.5395 - accuracy: 0.8152 - val_loss: 0.5341 - val_accuracy: 0.8147
    Epoch 5/5
    60000/60000 [==============================] - 2s 40us/sample - loss: 0.4918 - accuracy: 0.8289 - val_loss: 0.5007 - val_accuracy: 0.8225
    Accuracy: 0.8224999904632568
    ===============================================================
    learning_rate : 0.000429264034441806
    num_layers : 8
    num_nodes : 23
    hidden_activation : tanh
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 3s 45us/sample - loss: 0.7945 - accuracy: 0.7556 - val_loss: 0.5129 - val_accuracy: 0.8266
    Epoch 2/5
    60000/60000 [==============================] - 2s 36us/sample - loss: 0.4477 - accuracy: 0.8454 - val_loss: 0.4514 - val_accuracy: 0.8422
    Epoch 3/5
    60000/60000 [==============================] - 2s 41us/sample - loss: 0.3980 - accuracy: 0.8607 - val_loss: 0.4254 - val_accuracy: 0.8482
    Epoch 4/5
    60000/60000 [==============================] - 2s 38us/sample - loss: 0.3727 - accuracy: 0.8680 - val_loss: 0.4291 - val_accuracy: 0.8461
    Epoch 5/5
    60000/60000 [==============================] - 2s 36us/sample - loss: 0.3565 - accuracy: 0.8734 - val_loss: 0.4005 - val_accuracy: 0.8600
    Accuracy: 0.8600000143051147
    ===============================================================
    learning_rate : 0.0001
    num_layers : 3
    num_nodes : 217
    hidden_activation : tanh
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 3s 52us/sample - loss: 0.7203 - accuracy: 0.7672 - val_loss: 0.5410 - val_accuracy: 0.8192
    Epoch 2/5
    60000/60000 [==============================] - 3s 47us/sample - loss: 0.4798 - accuracy: 0.8360 - val_loss: 0.4781 - val_accuracy: 0.8323
    Epoch 3/5
    60000/60000 [==============================] - 2s 41us/sample - loss: 0.4353 - accuracy: 0.8490 - val_loss: 0.4502 - val_accuracy: 0.8419
    Epoch 4/5
    60000/60000 [==============================] - 2s 41us/sample - loss: 0.4106 - accuracy: 0.8554 - val_loss: 0.4320 - val_accuracy: 0.8458
    Epoch 5/5
    60000/60000 [==============================] - 2s 40us/sample - loss: 0.3938 - accuracy: 0.8607 - val_loss: 0.4222 - val_accuracy: 0.8474
    Accuracy: 0.8474000096321106
    ===============================================================
    learning_rate : 0.0010477283175289692
    num_layers : 5
    num_nodes : 293
    hidden_activation : tanh
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 5s 81us/sample - loss: 0.4724 - accuracy: 0.8274 - val_loss: 0.4396 - val_accuracy: 0.8382
    Epoch 2/5
    60000/60000 [==============================] - 4s 72us/sample - loss: 0.3695 - accuracy: 0.8638 - val_loss: 0.3976 - val_accuracy: 0.8588
    Epoch 3/5
    60000/60000 [==============================] - 4s 68us/sample - loss: 0.3336 - accuracy: 0.8763 - val_loss: 0.3976 - val_accuracy: 0.8584
    Epoch 4/5
    60000/60000 [==============================] - 5s 77us/sample - loss: 0.3103 - accuracy: 0.8845 - val_loss: 0.3478 - val_accuracy: 0.8732
    Epoch 5/5
    60000/60000 [==============================] - 4s 63us/sample - loss: 0.2933 - accuracy: 0.8893 - val_loss: 0.3745 - val_accuracy: 0.8640
    Accuracy: 0.8640000224113464
    ===============================================================
    learning_rate : 0.00102024922721958
    num_layers : 5
    num_nodes : 210
    hidden_activation : relu
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 4s 73us/sample - loss: 0.4862 - accuracy: 0.8251 - val_loss: 0.4290 - val_accuracy: 0.8449
    Epoch 2/5
    60000/60000 [==============================] - 4s 61us/sample - loss: 0.3577 - accuracy: 0.8689 - val_loss: 0.4286 - val_accuracy: 0.8260
    Epoch 3/5
    60000/60000 [==============================] - 4s 61us/sample - loss: 0.3233 - accuracy: 0.8790 - val_loss: 0.3596 - val_accuracy: 0.8676
    Epoch 4/5
    60000/60000 [==============================] - 4s 62us/sample - loss: 0.3029 - accuracy: 0.8873 - val_loss: 0.3705 - val_accuracy: 0.8674
    Epoch 5/5
    60000/60000 [==============================] - 4s 63us/sample - loss: 0.2843 - accuracy: 0.8926 - val_loss: 0.3549 - val_accuracy: 0.8707
    Accuracy: 0.8707000017166138
    ===============================================================
    learning_rate : 0.0010349391420051062
    num_layers : 4
    num_nodes : 247
    hidden_activation : relu
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 3s 55us/sample - loss: 0.4840 - accuracy: 0.8283 - val_loss: 0.4261 - val_accuracy: 0.8468
    Epoch 2/5
    60000/60000 [==============================] - 3s 44us/sample - loss: 0.3593 - accuracy: 0.8672 - val_loss: 0.3710 - val_accuracy: 0.8613
    Epoch 3/5
    60000/60000 [==============================] - 3s 51us/sample - loss: 0.3215 - accuracy: 0.8801 - val_loss: 0.4057 - val_accuracy: 0.8477
    Epoch 4/5
    60000/60000 [==============================] - 3s 44us/sample - loss: 0.2979 - accuracy: 0.8894 - val_loss: 0.3502 - val_accuracy: 0.8752
    Epoch 5/5
    60000/60000 [==============================] - 3s 42us/sample - loss: 0.2800 - accuracy: 0.8949 - val_loss: 0.3615 - val_accuracy: 0.8719
    Accuracy: 0.8719000220298767
    ===============================================================
    learning_rate : 0.0010959690274024401
    num_layers : 4
    num_nodes : 287
    hidden_activation : relu
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 3s 56us/sample - loss: 0.4707 - accuracy: 0.8316 - val_loss: 0.4120 - val_accuracy: 0.8541
    Epoch 2/5
    60000/60000 [==============================] - 3s 48us/sample - loss: 0.3529 - accuracy: 0.8705 - val_loss: 0.3746 - val_accuracy: 0.8624
    Epoch 3/5
    60000/60000 [==============================] - 3s 47us/sample - loss: 0.3180 - accuracy: 0.8831 - val_loss: 0.3646 - val_accuracy: 0.8674
    Epoch 4/5
    60000/60000 [==============================] - 3s 46us/sample - loss: 0.2963 - accuracy: 0.8898 - val_loss: 0.3638 - val_accuracy: 0.8674
    Epoch 5/5
    60000/60000 [==============================] - 3s 46us/sample - loss: 0.2796 - accuracy: 0.8954 - val_loss: 0.3458 - val_accuracy: 0.8757
    Accuracy: 0.8756999969482422
    ===============================================================
    learning_rate : 0.0001
    num_layers : 10
    num_nodes : 300
    hidden_activation : relu
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 8s 129us/sample - loss: 0.6030 - accuracy: 0.7870 - val_loss: 0.4605 - val_accuracy: 0.8352
    Epoch 2/5
    60000/60000 [==============================] - 6s 106us/sample - loss: 0.3958 - accuracy: 0.8571 - val_loss: 0.4102 - val_accuracy: 0.8523
    Epoch 3/5
    60000/60000 [==============================] - 6s 104us/sample - loss: 0.3529 - accuracy: 0.8711 - val_loss: 0.3685 - val_accuracy: 0.8662
    Epoch 4/5
    60000/60000 [==============================] - 7s 117us/sample - loss: 0.3216 - accuracy: 0.8820 - val_loss: 0.3642 - val_accuracy: 0.8682
    Epoch 5/5
    60000/60000 [==============================] - 6s 102us/sample - loss: 0.2998 - accuracy: 0.8892 - val_loss: 0.3535 - val_accuracy: 0.8705
    Accuracy: 0.8705000281333923
    ===============================================================
    learning_rate : 0.00020383138747104762
    num_layers : 4
    num_nodes : 104
    hidden_activation : relu
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 2s 41us/sample - loss: 0.6682 - accuracy: 0.7794 - val_loss: 0.4898 - val_accuracy: 0.8252
    Epoch 2/5
    60000/60000 [==============================] - 2s 34us/sample - loss: 0.4296 - accuracy: 0.8495 - val_loss: 0.4426 - val_accuracy: 0.8400
    Epoch 3/5
    60000/60000 [==============================] - 2s 32us/sample - loss: 0.3893 - accuracy: 0.8623 - val_loss: 0.4084 - val_accuracy: 0.8536
    Epoch 4/5
    60000/60000 [==============================] - 2s 34us/sample - loss: 0.3653 - accuracy: 0.8706 - val_loss: 0.3986 - val_accuracy: 0.8597s
    Epoch 5/5
    60000/60000 [==============================] - 2s 33us/sample - loss: 0.3475 - accuracy: 0.8756 - val_loss: 0.3794 - val_accuracy: 0.8647
    Accuracy: 0.8647000193595886
    ===============================================================
    learning_rate : 0.02082999238573391
    num_layers : 3
    num_nodes : 300
    hidden_activation : sigmoid
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 3s 46us/sample - loss: 0.6095 - accuracy: 0.7810 - val_loss: 0.6286 - val_accuracy: 0.7822
    Epoch 2/5
    60000/60000 [==============================] - 2s 41us/sample - loss: 0.5636 - accuracy: 0.7990 - val_loss: 0.6119 - val_accuracy: 0.7829
    Epoch 3/5
    60000/60000 [==============================] - 2s 41us/sample - loss: 0.5409 - accuracy: 0.8133 - val_loss: 0.7654 - val_accuracy: 0.7268
    Epoch 4/5
    60000/60000 [==============================] - 2s 39us/sample - loss: 0.5680 - accuracy: 0.7968 - val_loss: 0.5212 - val_accuracy: 0.8254
    Epoch 5/5
    60000/60000 [==============================] - 2s 41us/sample - loss: 0.5530 - accuracy: 0.8050 - val_loss: 0.5689 - val_accuracy: 0.8003
    Accuracy: 0.8003000020980835
    ===============================================================
    learning_rate : 0.00017526610645449532
    num_layers : 3
    num_nodes : 300
    hidden_activation : tanh
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 3s 53us/sample - loss: 0.5987 - accuracy: 0.7985 - val_loss: 0.4871 - val_accuracy: 0.8292
    Epoch 2/5
    60000/60000 [==============================] - 3s 56us/sample - loss: 0.4312 - accuracy: 0.8488 - val_loss: 0.4368 - val_accuracy: 0.8435
    Epoch 3/5
    60000/60000 [==============================] - 3s 47us/sample - loss: 0.3963 - accuracy: 0.8589 - val_loss: 0.4226 - val_accuracy: 0.8473
    Epoch 4/5
    60000/60000 [==============================] - 3s 45us/sample - loss: 0.3733 - accuracy: 0.8674 - val_loss: 0.4035 - val_accuracy: 0.8550
    Epoch 5/5
    60000/60000 [==============================] - 3s 45us/sample - loss: 0.3576 - accuracy: 0.8728 - val_loss: 0.3971 - val_accuracy: 0.8554
    Accuracy: 0.855400025844574
    ===============================================================
    learning_rate : 0.0012703581403242432
    num_layers : 10
    num_nodes : 300
    hidden_activation : relu
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 9s 146us/sample - loss: 0.5683 - accuracy: 0.7897 - val_loss: 0.4382 - val_accuracy: 0.8441
    Epoch 2/5
    60000/60000 [==============================] - 7s 115us/sample - loss: 0.4133 - accuracy: 0.8521 - val_loss: 0.4615 - val_accuracy: 0.8428
    Epoch 3/5
    60000/60000 [==============================] - 7s 112us/sample - loss: 0.3723 - accuracy: 0.8659 - val_loss: 0.4029 - val_accuracy: 0.8638
    Epoch 4/5
    60000/60000 [==============================] - 8s 129us/sample - loss: 0.3483 - accuracy: 0.8756 - val_loss: 0.3770 - val_accuracy: 0.8691
    Epoch 5/5
    60000/60000 [==============================] - 7s 121us/sample - loss: 0.3321 - accuracy: 0.8821 - val_loss: 0.3851 - val_accuracy: 0.8673
    Accuracy: 0.8672999739646912
    ===============================================================
    learning_rate : 0.00027941925672537467
    num_layers : 10
    num_nodes : 300
    hidden_activation : sigmoid
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 9s 151us/sample - loss: 1.8735 - accuracy: 0.1763 - val_loss: 1.6819 - val_accuracy: 0.2438
    Epoch 2/5
    60000/60000 [==============================] - 8s 135us/sample - loss: 1.2350 - accuracy: 0.4680 - val_loss: 0.8864 - val_accuracy: 0.6570
    Epoch 3/5
    60000/60000 [==============================] - 10s 160us/sample - loss: 0.7894 - accuracy: 0.6994 - val_loss: 0.7365 - val_accuracy: 0.7333
    Epoch 4/5
    60000/60000 [==============================] - 8s 131us/sample - loss: 0.6876 - accuracy: 0.7560 - val_loss: 0.6959 - val_accuracy: 0.7529
    Epoch 5/5
    60000/60000 [==============================] - 7s 122us/sample - loss: 0.6379 - accuracy: 0.7742 - val_loss: 0.6899 - val_accuracy: 0.7601
    Accuracy: 0.7601000070571899
    ===============================================================
    learning_rate : 0.00014296843026585703
    num_layers : 10
    num_nodes : 300
    hidden_activation : relu
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 11s 183us/sample - loss: 0.5845 - accuracy: 0.7965 - val_loss: 0.4716 - val_accuracy: 0.8277
    Epoch 2/5
    60000/60000 [==============================] - 8s 140us/sample - loss: 0.3811 - accuracy: 0.8612 - val_loss: 0.4017 - val_accuracy: 0.8540
    Epoch 3/5
    60000/60000 [==============================] - 8s 137us/sample - loss: 0.3377 - accuracy: 0.8761 - val_loss: 0.3720 - val_accuracy: 0.8616
    Epoch 4/5
    60000/60000 [==============================] - 8s 133us/sample - loss: 0.3153 - accuracy: 0.8849 - val_loss: 0.3693 - val_accuracy: 0.8649
    Epoch 5/5
    60000/60000 [==============================] - 10s 169us/sample - loss: 0.2896 - accuracy: 0.8932 - val_loss: 0.3653 - val_accuracy: 0.8645
    Accuracy: 0.8644999861717224
    ===============================================================
    learning_rate : 0.0002718089207291075
    num_layers : 3
    num_nodes : 300
    hidden_activation : tanh
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 5s 90us/sample - loss: 0.5546 - accuracy: 0.8089 - val_loss: 0.4590 - val_accuracy: 0.8340
    Epoch 2/5
    60000/60000 [==============================] - 4s 69us/sample - loss: 0.4133 - accuracy: 0.8535 - val_loss: 0.4291 - val_accuracy: 0.8460
    Epoch 3/5
    60000/60000 [==============================] - 3s 53us/sample - loss: 0.3786 - accuracy: 0.8640 - val_loss: 0.3965 - val_accuracy: 0.8589
    Epoch 4/5
    60000/60000 [==============================] - 2s 40us/sample - loss: 0.3573 - accuracy: 0.8724 - val_loss: 0.3883 - val_accuracy: 0.8619
    Epoch 5/5
    60000/60000 [==============================] - 2s 38us/sample - loss: 0.3396 - accuracy: 0.8781 - val_loss: 0.3822 - val_accuracy: 0.8636
    Accuracy: 0.8636000156402588
    ===============================================================
    learning_rate : 0.005393522075624546
    num_layers : 9
    num_nodes : 61
    hidden_activation : tanh
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 3s 58us/sample - loss: 0.6200 - accuracy: 0.7772 - val_loss: 0.5604 - val_accuracy: 0.7798
    Epoch 2/5
    60000/60000 [==============================] - 3s 44us/sample - loss: 0.5633 - accuracy: 0.8014 - val_loss: 0.5756 - val_accuracy: 0.8051
    Epoch 3/5
    60000/60000 [==============================] - 3s 45us/sample - loss: 0.5432 - accuracy: 0.8094 - val_loss: 0.5619 - val_accuracy: 0.8048
    Epoch 4/5
    60000/60000 [==============================] - 3s 42us/sample - loss: 0.5262 - accuracy: 0.8189 - val_loss: 0.5870 - val_accuracy: 0.8040
    Epoch 5/5
    60000/60000 [==============================] - 3s 46us/sample - loss: 0.5546 - accuracy: 0.8049 - val_loss: 0.5619 - val_accuracy: 0.8104
    Accuracy: 0.8104000091552734
    ===============================================================
    learning_rate : 0.002748831838342572
    num_layers : 3
    num_nodes : 149
    hidden_activation : tanh
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 3s 51us/sample - loss: 0.4772 - accuracy: 0.8263 - val_loss: 0.4066 - val_accuracy: 0.8549
    Epoch 2/5
    60000/60000 [==============================] - 2s 41us/sample - loss: 0.3747 - accuracy: 0.8631 - val_loss: 0.3900 - val_accuracy: 0.8594
    Epoch 3/5
    60000/60000 [==============================] - 3s 44us/sample - loss: 0.3491 - accuracy: 0.8724 - val_loss: 0.3788 - val_accuracy: 0.8631
    Epoch 4/5
    60000/60000 [==============================] - 2s 33us/sample - loss: 0.3345 - accuracy: 0.8776 - val_loss: 0.3663 - val_accuracy: 0.8665
    Epoch 5/5
    60000/60000 [==============================] - 2s 33us/sample - loss: 0.3209 - accuracy: 0.8817 - val_loss: 0.3939 - val_accuracy: 0.8602
    Accuracy: 0.8601999878883362
    ===============================================================
    learning_rate : 0.0011261564522785036
    num_layers : 3
    num_nodes : 300
    hidden_activation : sigmoid
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 3s 51us/sample - loss: 0.5375 - accuracy: 0.8143 - val_loss: 0.4497 - val_accuracy: 0.8375
    Epoch 2/5
    60000/60000 [==============================] - 3s 42us/sample - loss: 0.3958 - accuracy: 0.8574 - val_loss: 0.4093 - val_accuracy: 0.8543
    Epoch 3/5
    60000/60000 [==============================] - 2s 39us/sample - loss: 0.3586 - accuracy: 0.8706 - val_loss: 0.3891 - val_accuracy: 0.8569
    Epoch 4/5
    60000/60000 [==============================] - 3s 42us/sample - loss: 0.3336 - accuracy: 0.8789 - val_loss: 0.3783 - val_accuracy: 0.8616
    Epoch 5/5
    60000/60000 [==============================] - 3s 43us/sample - loss: 0.3131 - accuracy: 0.8853 - val_loss: 0.3685 - val_accuracy: 0.8640
    Accuracy: 0.8640000224113464
    ===============================================================
    learning_rate : 0.0013618064607208954
    num_layers : 10
    num_nodes : 10
    hidden_activation : tanh
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 3s 51us/sample - loss: 0.8767 - accuracy: 0.7169 - val_loss: 0.6025 - val_accuracy: 0.7988
    Epoch 2/5
    60000/60000 [==============================] - 2s 32us/sample - loss: 0.5123 - accuracy: 0.8277 - val_loss: 0.5088 - val_accuracy: 0.8272
    Epoch 3/5
    60000/60000 [==============================] - 2s 32us/sample - loss: 0.4626 - accuracy: 0.8424 - val_loss: 0.5001 - val_accuracy: 0.8301
    Epoch 4/5
    60000/60000 [==============================] - 2s 31us/sample - loss: 0.4402 - accuracy: 0.8500 - val_loss: 0.4895 - val_accuracy: 0.8258
    Epoch 5/5
    60000/60000 [==============================] - 2s 37us/sample - loss: 0.4269 - accuracy: 0.8516 - val_loss: 0.4589 - val_accuracy: 0.8435
    Accuracy: 0.843500018119812
    ===============================================================
    learning_rate : 0.0008163994897857569
    num_layers : 10
    num_nodes : 83
    hidden_activation : tanh
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 5s 82us/sample - loss: 0.5160 - accuracy: 0.8139 - val_loss: 0.4706 - val_accuracy: 0.8309
    Epoch 2/5
    60000/60000 [==============================] - 3s 46us/sample - loss: 0.3906 - accuracy: 0.8577 - val_loss: 0.4144 - val_accuracy: 0.8493
    Epoch 3/5
    60000/60000 [==============================] - 3s 49us/sample - loss: 0.3564 - accuracy: 0.8696 - val_loss: 0.4010 - val_accuracy: 0.8552
    Epoch 4/5
    60000/60000 [==============================] - 4s 59us/sample - loss: 0.3369 - accuracy: 0.8758 - val_loss: 0.3719 - val_accuracy: 0.8661
    Epoch 5/5
    60000/60000 [==============================] - 3s 46us/sample - loss: 0.3186 - accuracy: 0.8842 - val_loss: 0.3772 - val_accuracy: 0.8591
    Accuracy: 0.8590999841690063
    ===============================================================
    learning_rate : 0.004859914503986795
    num_layers : 3
    num_nodes : 10
    hidden_activation : relu
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 2s 32us/sample - loss: 0.7010 - accuracy: 0.7459 - val_loss: 0.5533 - val_accuracy: 0.8055
    Epoch 2/5
    60000/60000 [==============================] - 2s 31us/sample - loss: 0.5218 - accuracy: 0.8160 - val_loss: 0.5414 - val_accuracy: 0.8071
    Epoch 3/5
    60000/60000 [==============================] - 2s 30us/sample - loss: 0.4890 - accuracy: 0.8274 - val_loss: 0.5145 - val_accuracy: 0.8166
    Epoch 4/5
    60000/60000 [==============================] - 2s 31us/sample - loss: 0.4717 - accuracy: 0.8333 - val_loss: 0.4995 - val_accuracy: 0.8263
    Epoch 5/5
    60000/60000 [==============================] - 2s 30us/sample - loss: 0.4617 - accuracy: 0.8370 - val_loss: 0.4829 - val_accuracy: 0.8324
    Accuracy: 0.8324000239372253
    ===============================================================
    learning_rate : 0.0006429249378625206
    num_layers : 5
    num_nodes : 293
    hidden_activation : sigmoid
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 5s 90us/sample - loss: 0.7069 - accuracy: 0.7444 - val_loss: 0.4825 - val_accuracy: 0.8222
    Epoch 2/5
    60000/60000 [==============================] - 4s 75us/sample - loss: 0.4182 - accuracy: 0.8485 - val_loss: 0.4113 - val_accuracy: 0.8513
    Epoch 3/5
    60000/60000 [==============================] - 5s 85us/sample - loss: 0.3735 - accuracy: 0.8644 - val_loss: 0.3878 - val_accuracy: 0.8587
    Epoch 4/5
    60000/60000 [==============================] - 4s 72us/sample - loss: 0.3474 - accuracy: 0.8740 - val_loss: 0.3872 - val_accuracy: 0.8616
    Epoch 5/5
    60000/60000 [==============================] - 3s 57us/sample - loss: 0.3296 - accuracy: 0.8798 - val_loss: 0.3614 - val_accuracy: 0.8688
    Accuracy: 0.8687999844551086
    ===============================================================
    learning_rate : 0.00035429378429707584
    num_layers : 3
    num_nodes : 300
    hidden_activation : tanh
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 3s 49us/sample - loss: 0.5305 - accuracy: 0.8173 - val_loss: 0.4762 - val_accuracy: 0.8245
    Epoch 2/5
    60000/60000 [==============================] - 3s 45us/sample - loss: 0.4011 - accuracy: 0.8566 - val_loss: 0.4300 - val_accuracy: 0.8439
    Epoch 3/5
    60000/60000 [==============================] - 3s 44us/sample - loss: 0.3677 - accuracy: 0.8669 - val_loss: 0.3903 - val_accuracy: 0.8598
    Epoch 4/5
    60000/60000 [==============================] - 3s 43us/sample - loss: 0.3449 - accuracy: 0.8754 - val_loss: 0.3780 - val_accuracy: 0.8619
    Epoch 5/5
    60000/60000 [==============================] - 3s 43us/sample - loss: 0.3294 - accuracy: 0.8803 - val_loss: 0.3749 - val_accuracy: 0.8656
    Accuracy: 0.8655999898910522
    ===============================================================
    learning_rate : 0.000862706928068602
    num_layers : 3
    num_nodes : 136
    hidden_activation : relu
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 3s 42us/sample - loss: 0.5292 - accuracy: 0.8163 - val_loss: 0.4592 - val_accuracy: 0.8392
    Epoch 2/5
    60000/60000 [==============================] - 2s 34us/sample - loss: 0.3909 - accuracy: 0.8613 - val_loss: 0.4179 - val_accuracy: 0.8497
    Epoch 3/5
    60000/60000 [==============================] - 2s 32us/sample - loss: 0.3528 - accuracy: 0.8725 - val_loss: 0.3694 - val_accuracy: 0.8666
    Epoch 4/5
    60000/60000 [==============================] - 2s 33us/sample - loss: 0.3256 - accuracy: 0.8812 - val_loss: 0.3770 - val_accuracy: 0.8650
    Epoch 5/5
    60000/60000 [==============================] - 2s 33us/sample - loss: 0.3082 - accuracy: 0.8868 - val_loss: 0.3543 - val_accuracy: 0.8733
    Accuracy: 0.8733000159263611
    ===============================================================
    learning_rate : 0.00036045488075365134
    num_layers : 3
    num_nodes : 300
    hidden_activation : tanh
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 4s 61us/sample - loss: 0.5334 - accuracy: 0.8135 - val_loss: 0.4477 - val_accuracy: 0.8397
    Epoch 2/5
    60000/60000 [==============================] - 3s 43us/sample - loss: 0.4022 - accuracy: 0.8557 - val_loss: 0.4066 - val_accuracy: 0.8548
    Epoch 3/5
    60000/60000 [==============================] - 2s 41us/sample - loss: 0.3660 - accuracy: 0.8684 - val_loss: 0.3867 - val_accuracy: 0.8624
    Epoch 4/5
    60000/60000 [==============================] - 2s 40us/sample - loss: 0.3451 - accuracy: 0.8755 - val_loss: 0.3766 - val_accuracy: 0.8673
    Epoch 5/5
    60000/60000 [==============================] - 3s 50us/sample - loss: 0.3282 - accuracy: 0.8810 - val_loss: 0.4026 - val_accuracy: 0.8551
    Accuracy: 0.8550999760627747
    ===============================================================
    learning_rate : 0.00013074751859554868
    num_layers : 3
    num_nodes : 300
    hidden_activation : tanh
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 4s 58us/sample - loss: 0.6424 - accuracy: 0.7872 - val_loss: 0.4992 - val_accuracy: 0.8273
    Epoch 2/5
    60000/60000 [==============================] - 2s 40us/sample - loss: 0.4507 - accuracy: 0.8429 - val_loss: 0.4618 - val_accuracy: 0.8333
    Epoch 3/5
    60000/60000 [==============================] - 3s 49us/sample - loss: 0.4133 - accuracy: 0.8547 - val_loss: 0.4369 - val_accuracy: 0.8431
    Epoch 4/5
    60000/60000 [==============================] - 3s 50us/sample - loss: 0.3914 - accuracy: 0.8618 - val_loss: 0.4287 - val_accuracy: 0.8449
    Epoch 5/5
    60000/60000 [==============================] - 3s 52us/sample - loss: 0.3741 - accuracy: 0.8668 - val_loss: 0.4089 - val_accuracy: 0.8543
    Accuracy: 0.8543000221252441
    ===============================================================
    learning_rate : 0.0001
    num_layers : 10
    num_nodes : 300
    hidden_activation : relu
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 9s 150us/sample - loss: 0.6222 - accuracy: 0.7759 - val_loss: 0.4762 - val_accuracy: 0.8284
    Epoch 2/5
    60000/60000 [==============================] - 8s 131us/sample - loss: 0.3987 - accuracy: 0.8562 - val_loss: 0.4032 - val_accuracy: 0.8543
    Epoch 3/5
    60000/60000 [==============================] - 8s 133us/sample - loss: 0.3514 - accuracy: 0.8721 - val_loss: 0.4028 - val_accuracy: 0.8523
    Epoch 4/5
    60000/60000 [==============================] - 7s 120us/sample - loss: 0.3252 - accuracy: 0.8813 - val_loss: 0.3662 - val_accuracy: 0.8679
    Epoch 5/5
    60000/60000 [==============================] - 7s 117us/sample - loss: 0.3037 - accuracy: 0.8874 - val_loss: 0.3504 - val_accuracy: 0.8719
    Accuracy: 0.8719000220298767
    ===============================================================
    learning_rate : 0.000864159005598067
    num_layers : 3
    num_nodes : 66
    hidden_activation : relu
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 2s 39us/sample - loss: 0.5524 - accuracy: 0.8103 - val_loss: 0.4616 - val_accuracy: 0.8410
    Epoch 2/5
    60000/60000 [==============================] - 2s 35us/sample - loss: 0.4062 - accuracy: 0.8574 - val_loss: 0.4280 - val_accuracy: 0.8503
    Epoch 3/5
    60000/60000 [==============================] - 2s 36us/sample - loss: 0.3696 - accuracy: 0.8683 - val_loss: 0.4198 - val_accuracy: 0.8463
    Epoch 4/5
    60000/60000 [==============================] - 2s 32us/sample - loss: 0.3435 - accuracy: 0.8776 - val_loss: 0.3860 - val_accuracy: 0.8611
    Epoch 5/5
    60000/60000 [==============================] - 2s 30us/sample - loss: 0.3246 - accuracy: 0.8821 - val_loss: 0.3662 - val_accuracy: 0.8683
    Accuracy: 0.8683000206947327
    ===============================================================
    learning_rate : 0.0001
    num_layers : 10
    num_nodes : 261
    hidden_activation : relu
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 8s 126us/sample - loss: 0.6359 - accuracy: 0.7741 - val_loss: 0.4834 - val_accuracy: 0.8219
    Epoch 2/5
    60000/60000 [==============================] - 7s 109us/sample - loss: 0.4144 - accuracy: 0.8508 - val_loss: 0.4173 - val_accuracy: 0.8491
    Epoch 3/5
    60000/60000 [==============================] - 6s 102us/sample - loss: 0.3603 - accuracy: 0.8696 - val_loss: 0.3963 - val_accuracy: 0.8554
    Epoch 4/5
    60000/60000 [==============================] - 6s 102us/sample - loss: 0.3339 - accuracy: 0.8770 - val_loss: 0.3562 - val_accuracy: 0.8695
    Epoch 5/5
    60000/60000 [==============================] - 6s 108us/sample - loss: 0.3104 - accuracy: 0.8856 - val_loss: 0.3657 - val_accuracy: 0.8639
    Accuracy: 0.8639000058174133
    ===============================================================
    learning_rate : 0.0008602141287884932
    num_layers : 3
    num_nodes : 300
    hidden_activation : relu
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 4s 61us/sample - loss: 0.5006 - accuracy: 0.8246 - val_loss: 0.4508 - val_accuracy: 0.8363
    Epoch 2/5
    60000/60000 [==============================] - 3s 47us/sample - loss: 0.3707 - accuracy: 0.8658 - val_loss: 0.3795 - val_accuracy: 0.8650
    Epoch 3/5
    60000/60000 [==============================] - 3s 43us/sample - loss: 0.3338 - accuracy: 0.8793 - val_loss: 0.3682 - val_accuracy: 0.8688
    Epoch 4/5
    60000/60000 [==============================] - 4s 60us/sample - loss: 0.3089 - accuracy: 0.8874 - val_loss: 0.3550 - val_accuracy: 0.8690
    Epoch 5/5
    60000/60000 [==============================] - 3s 51us/sample - loss: 0.2884 - accuracy: 0.8947 - val_loss: 0.3816 - val_accuracy: 0.8637
    Accuracy: 0.8636999726295471
    ===============================================================
    learning_rate : 0.0008458057097445288
    num_layers : 3
    num_nodes : 10
    hidden_activation : relu
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 2s 34us/sample - loss: 0.8253 - accuracy: 0.7280 - val_loss: 0.5696 - val_accuracy: 0.8094
    Epoch 2/5
    60000/60000 [==============================] - 2s 28us/sample - loss: 0.5070 - accuracy: 0.8276 - val_loss: 0.5119 - val_accuracy: 0.8230
    Epoch 3/5
    60000/60000 [==============================] - 2s 27us/sample - loss: 0.4648 - accuracy: 0.8397 - val_loss: 0.4886 - val_accuracy: 0.8273
    Epoch 4/5
    60000/60000 [==============================] - 2s 25us/sample - loss: 0.4449 - accuracy: 0.8461 - val_loss: 0.4764 - val_accuracy: 0.8297
    Epoch 5/5
    60000/60000 [==============================] - 2s 26us/sample - loss: 0.4326 - accuracy: 0.8506 - val_loss: 0.4662 - val_accuracy: 0.8363
    Accuracy: 0.8363000154495239
    ===============================================================
    learning_rate : 0.0008482758527035384
    num_layers : 4
    num_nodes : 300
    hidden_activation : relu
    --------------------------------------------------------------
    WARNING:tensorflow:`batch_size` is no longer needed in the `TensorBoard` Callback and will be ignored in TensorFlow 2.0.
    Train on 60000 samples, validate on 10000 samples
    Epoch 1/5
    60000/60000 [==============================] - 4s 71us/sample - loss: 0.4772 - accuracy: 0.8282 - val_loss: 0.4176 - val_accuracy: 0.8490
    Epoch 2/5
    60000/60000 [==============================] - 3s 56us/sample - loss: 0.3541 - accuracy: 0.8693 - val_loss: 0.3830 - val_accuracy: 0.8567
    Epoch 3/5
    60000/60000 [==============================] - 3s 53us/sample - loss: 0.3202 - accuracy: 0.8824 - val_loss: 0.3756 - val_accuracy: 0.8650
    Epoch 4/5
    60000/60000 [==============================] - 3s 53us/sample - loss: 0.2956 - accuracy: 0.8892 - val_loss: 0.3493 - val_accuracy: 0.8705
    Epoch 5/5
    60000/60000 [==============================] - 3s 58us/sample - loss: 0.2796 - accuracy: 0.8956 - val_loss: 0.3374 - val_accuracy: 0.8780
    Accuracy: 0.878000020980835
    ===============================================================



```python
plot_convergence(search_result_gp)
```




    <matplotlib.axes._subplots.AxesSubplot at 0x635f0cc18>




![png](NeuralNetwork_3.2_HyperparameterTuning_files/NeuralNetwork_3.2_HyperparameterTuning_17_1.png)



```python
sorted(zip(search_result.func_vals, search_result.x_iters))
```




    [(-0.8802, [0.0002959462219949908, 7, 300, 'relu']),
     (-0.8788, [0.002190069004164229, 3, 188, 'relu']),
     (-0.8767, [0.0019588685500944304, 3, 198, 'sigmoid']),
     (-0.8753, [0.0008136447333568535, 6, 204, 'relu']),
     (-0.875, [0.0002543070771366, 5, 300, 'relu']),
     (-0.875, [0.0004263545856054099, 10, 300, 'relu']),
     (-0.8748, [0.00211913276820656, 5, 204, 'relu']),
     (-0.8742, [0.0006245130655079226, 6, 110, 'relu']),
     (-0.8741, [0.0021441596751991033, 4, 205, 'relu']),
     (-0.8741, [0.0031078230575074003, 5, 179, 'relu']),
     (-0.8733, [0.0005368559350389544, 3, 247, 'relu']),
     (-0.8733, [0.0014917236123558131, 5, 300, 'relu']),
     (-0.8733, [0.0025403614669968007, 5, 215, 'relu']),
     (-0.873, [0.0005777821047247657, 5, 300, 'tanh']),
     (-0.8728, [0.0010921985570836535, 4, 295, 'sigmoid']),
     (-0.8725, [0.00021325222660068934, 8, 289, 'tanh']),
     (-0.8705, [0.0001731221179533443, 6, 201, 'tanh']),
     (-0.8694, [0.0024891292746113992, 3, 117, 'relu']),
     (-0.8692, [0.00022148616780747255, 9, 125, 'relu']),
     (-0.8688, [0.0014607434782379874, 5, 300, 'relu']),
     (-0.8683, [0.0013718030910478862, 3, 300, 'tanh']),
     (-0.8676, [0.0015377237202258772, 8, 300, 'relu']),
     (-0.8673, [0.004161663364656439, 5, 242, 'sigmoid']),
     (-0.8667, [0.0001, 10, 300, 'relu']),
     (-0.8666, [0.0006384236766955954, 3, 300, 'sigmoid']),
     (-0.8659, [0.0041838244571849375, 4, 296, 'relu']),
     (-0.8656, [0.0001, 6, 300, 'relu']),
     (-0.8656, [0.002310206296046986, 7, 179, 'relu']),
     (-0.8646, [0.002342779409035649, 4, 222, 'relu']),
     (-0.8642, [0.000687514796452139, 3, 63, 'relu']),
     (-0.8622, [0.0021703045203809884, 5, 205, 'relu']),
     (-0.8614, [0.0022692413840411214, 6, 85, 'sigmoid']),
     (-0.859, [0.00228613065086726, 4, 212, 'sigmoid']),
     (-0.8553, [0.0030360313129710326, 3, 50, 'sigmoid']),
     (-0.8516, [0.0001, 3, 300, 'relu']),
     (-0.8417, [0.009723073301251328, 3, 300, 'sigmoid']),
     (-0.8371, [0.0012403912672125997, 3, 10, 'sigmoid']),
     (-0.8335, [0.009137676680624587, 7, 183, 'relu']),
     (-0.8323, [0.0001, 3, 300, 'sigmoid']),
     (-0.8315, [0.002164647984422405, 4, 10, 'relu']),
     (-0.8314, [0.00014594682763003234, 9, 25, 'relu']),
     (-0.831, [0.01, 3, 16, 'relu']),
     (-0.8293, [0.00024465639924243034, 3, 10, 'relu']),
     (-0.8221, [0.0008311749291350613, 10, 10, 'relu']),
     (-0.8186, [0.020110421609520018, 3, 147, 'sigmoid']),
     (-0.8087, [0.0022611616626187223, 9, 264, 'sigmoid']),
     (-0.799, [0.0001071718121090779, 8, 10, 'tanh']),
     (-0.7958, [0.00038907294706676173, 8, 224, 'sigmoid']),
     (-0.6556, [0.05774360324692692, 3, 281, 'tanh']),
     (-0.5557, [0.012861204033050726, 10, 10, 'sigmoid'])]




```python
print('Best Parameter Set')
print('- Learning rate : {}'.format(search_result.x[0]))
print('- Number of layers : {}'.format(search_result.x[1]))
print('- Number of nodes : {}'.format(search_result.x[2]))
print('- Activation function : {}'.format(search_result.x[3]))
```

    Best Parameter Set
    - Learning rate : 0.0002959462219949908
    - Number of layers : 7
    - Number of nodes : 300
    - Activation function : relu



```python
model = load_model(path_best_model)
```


```python
test_loss, test_acc = model.evaluate(x = test_images.T, 
                                     y = test_labels.T)
```

    10000/1 [================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================] - 1s 69us/sample - loss: 0.2637 - accuracy: 0.8802



```python
print('Test accuracy and loss with best model')
print('Test loss : {}'.format(test_loss))
print('Test accuracy : {}'.format(test_acc))
```

    Test accuracy and loss with best model
    Test loss : 0.3292090726137161
    Test accuracy : 0.8802000284194946

